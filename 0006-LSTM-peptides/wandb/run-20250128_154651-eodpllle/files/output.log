Using configuration: {'epochs': 50, 'batch_size': 8, 'learning_rate': 0.00063, 'layers': 2, 'output_size': 22, 'hidden_size': 256, 'dropout': 0.7}
longest peptide: 30 AA
Size of peptides for model: 30
Total peptides: 14220
Training set size: 12087
Test set size: 2133
Max index: 21, Vocab size: 22

-------Starting Training-------
_________________________________
Epoch [1/50]: 100%|██████████████████████████████████████| 1510/1510 [00:28<00:00, 53.57it/s, accuracy=tensor(0.6681), loss=1.09]
Epoch [1/50], Loss: 1.419938471459395, Accuracy: 0.5733988881111145
Epoch [2/50]: 100%|██████████████████████████████████████| 1510/1510 [00:30<00:00, 49.54it/s, accuracy=tensor(0.6207), loss=1.17]
Epoch [2/50], Loss: 1.2497785252451108, Accuracy: 0.6219485402107239
Epoch [3/50]: 100%|█████████████████████████████████████| 1510/1510 [00:27<00:00, 55.09it/s, accuracy=tensor(0.7069), loss=0.942]
Epoch [3/50], Loss: 1.1461615370204117, Accuracy: 0.6564570069313049
Epoch [4/50]: 100%|█████████████████████████████████████| 1510/1510 [00:30<00:00, 49.42it/s, accuracy=tensor(0.7500), loss=0.826]
Epoch [4/50], Loss: 1.0610974571365395, Accuracy: 0.685279369354248
Epoch [5/50]: 100%|██████████████████████████████████████| 1510/1510 [00:27<00:00, 55.08it/s, accuracy=tensor(0.6767), loss=1.07]
Epoch [5/50], Loss: 0.9943732406919366, Accuracy: 0.7064857482910156
Epoch [6/50]: 100%|██████████████████████████████████████| 1510/1510 [00:27<00:00, 55.13it/s, accuracy=tensor(0.6681), loss=1.06]
Epoch [6/50], Loss: 0.9425498723391665, Accuracy: 0.7229524254798889
Epoch [7/50]: 100%|█████████████████████████████████████| 1510/1510 [00:27<00:00, 54.93it/s, accuracy=tensor(0.7198), loss=0.965]
Epoch [7/50], Loss: 0.8991829709501455, Accuracy: 0.7370750308036804
Epoch [8/50]: 100%|██████████████████████████████████████| 1510/1510 [00:27<00:00, 55.04it/s, accuracy=tensor(0.7069), loss=0.94]
Epoch [8/50], Loss: 0.8639461914435128, Accuracy: 0.7473704218864441
Epoch [9/50]: 100%|█████████████████████████████████████| 1510/1510 [00:27<00:00, 55.48it/s, accuracy=tensor(0.7500), loss=0.855]
Epoch [9/50], Loss: 0.8301849491154121, Accuracy: 0.7571020126342773
Epoch [10/50]: 100%|████████████████████████████████████| 1510/1510 [00:30<00:00, 50.00it/s, accuracy=tensor(0.7672), loss=0.657]
Epoch [10/50], Loss: 0.8032511562701092, Accuracy: 0.7652177810668945
Epoch [11/50]: 100%|█████████████████████████████████████| 1510/1510 [00:28<00:00, 53.09it/s, accuracy=tensor(0.8060), loss=0.72]
Epoch [11/50], Loss: 0.779551324406207, Accuracy: 0.7725226879119873
Epoch [12/50]: 100%|█████████████████████████████████████| 1510/1510 [00:27<00:00, 54.73it/s, accuracy=tensor(0.8448), loss=0.63]
Epoch [12/50], Loss: 0.7573003659777294, Accuracy: 0.7781433463096619
Epoch [13/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 54.79it/s, accuracy=tensor(0.8190), loss=0.613]
Epoch [13/50], Loss: 0.7367958434764913, Accuracy: 0.7840997576713562
Epoch [14/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 54.08it/s, accuracy=tensor(0.8405), loss=0.533]
Epoch [14/50], Loss: 0.7182237473742061, Accuracy: 0.7898604273796082
Epoch [15/50]: 100%|█████████████████████████████████████| 1510/1510 [00:28<00:00, 53.52it/s, accuracy=tensor(0.6810), loss=1.09]
Epoch [15/50], Loss: 0.7002035496250683, Accuracy: 0.795003354549408
Epoch [16/50]: 100%|████████████████████████████████████| 1510/1510 [00:28<00:00, 53.29it/s, accuracy=tensor(0.8966), loss=0.396]
Epoch [16/50], Loss: 0.6852618468913021, Accuracy: 0.7988805770874023
Epoch [17/50]: 100%|████████████████████████████████████| 1510/1510 [00:28<00:00, 52.69it/s, accuracy=tensor(0.8060), loss=0.723]
Epoch [17/50], Loss: 0.6707778982374052, Accuracy: 0.8037992119789124
Epoch [18/50]: 100%|████████████████████████████████████| 1510/1510 [00:28<00:00, 53.40it/s, accuracy=tensor(0.7759), loss=0.815]
Epoch [18/50], Loss: 0.6566924582846118, Accuracy: 0.8075307607650757
Epoch [19/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 54.08it/s, accuracy=tensor(0.7931), loss=0.657]
Epoch [19/50], Loss: 0.6444682621403246, Accuracy: 0.8105965852737427
Epoch [20/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 54.52it/s, accuracy=tensor(0.8190), loss=0.634]
Epoch [20/50], Loss: 0.6315697841099556, Accuracy: 0.8144388794898987
Epoch [21/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 54.92it/s, accuracy=tensor(0.7974), loss=0.622]
Epoch [21/50], Loss: 0.6212746693993246, Accuracy: 0.8167465925216675
Epoch [22/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 54.48it/s, accuracy=tensor(0.8534), loss=0.582]
Epoch [22/50], Loss: 0.6111108384187648, Accuracy: 0.8197935819625854
Epoch [23/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 54.91it/s, accuracy=tensor(0.8190), loss=0.617]
Epoch [23/50], Loss: 0.60143127836139, Accuracy: 0.8225855231285095
Epoch [24/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 54.13it/s, accuracy=tensor(0.7198), loss=0.903]
Epoch [24/50], Loss: 0.592940019594123, Accuracy: 0.8255932331085205
Epoch [25/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 54.59it/s, accuracy=tensor(0.8060), loss=0.659]
Epoch [25/50], Loss: 0.583229231321259, Accuracy: 0.8279241323471069
Epoch [26/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 54.83it/s, accuracy=tensor(0.8534), loss=0.499]
Epoch [26/50], Loss: 0.5749255226542618, Accuracy: 0.8301504254341125
Epoch [27/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 54.91it/s, accuracy=tensor(0.8103), loss=0.635]
Epoch [27/50], Loss: 0.5682657221492553, Accuracy: 0.8319263458251953
Epoch [28/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 54.56it/s, accuracy=tensor(0.7716), loss=0.761]
Epoch [28/50], Loss: 0.5595718021621767, Accuracy: 0.8346346020698547
Epoch [29/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 54.50it/s, accuracy=tensor(0.8664), loss=0.426]
Epoch [29/50], Loss: 0.5546442215016346, Accuracy: 0.8362920880317688
Epoch [30/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 55.07it/s, accuracy=tensor(0.8190), loss=0.637]
Epoch [30/50], Loss: 0.5477019514271755, Accuracy: 0.8376151919364929
Epoch [31/50]: 100%|████████████████████████████████████| 1510/1510 [00:28<00:00, 53.07it/s, accuracy=tensor(0.8276), loss=0.579]
Epoch [31/50], Loss: 0.5403988553396124, Accuracy: 0.8395188450813293
Epoch [32/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 54.86it/s, accuracy=tensor(0.8405), loss=0.538]
Epoch [32/50], Loss: 0.5340390311763776, Accuracy: 0.8411651849746704
Epoch [33/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 55.21it/s, accuracy=tensor(0.8534), loss=0.518]
Epoch [33/50], Loss: 0.5298128330154924, Accuracy: 0.8423669934272766
Epoch [34/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 54.97it/s, accuracy=tensor(0.8190), loss=0.614]
Epoch [34/50], Loss: 0.5249096605951423, Accuracy: 0.8442944884300232
Epoch [35/50]: 100%|████████████████████████████████████| 1510/1510 [00:29<00:00, 50.87it/s, accuracy=tensor(0.8060), loss=0.665]
Epoch [35/50], Loss: 0.5200646930577739, Accuracy: 0.8453719019889832
Epoch [36/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 54.03it/s, accuracy=tensor(0.8319), loss=0.559]
Epoch [36/50], Loss: 0.514935329674885, Accuracy: 0.8470463156700134
Epoch [37/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 55.09it/s, accuracy=tensor(0.8103), loss=0.632]
Epoch [37/50], Loss: 0.5105708769615123, Accuracy: 0.847948431968689
Epoch [38/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 53.99it/s, accuracy=tensor(0.8578), loss=0.469]
Epoch [38/50], Loss: 0.5063322233245863, Accuracy: 0.8492987155914307
Epoch [39/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 55.13it/s, accuracy=tensor(0.8879), loss=0.398]
Epoch [39/50], Loss: 0.5039006798472625, Accuracy: 0.8498213291168213
Epoch [40/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 55.13it/s, accuracy=tensor(0.8276), loss=0.523]
Epoch [40/50], Loss: 0.49881002816143416, Accuracy: 0.851270854473114
Epoch [41/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 55.34it/s, accuracy=tensor(0.8793), loss=0.418]
Epoch [41/50], Loss: 0.4953081974525325, Accuracy: 0.8524763584136963
Epoch [42/50]: 100%|██████████████████████████████████████| 1510/1510 [00:27<00:00, 54.85it/s, accuracy=tensor(0.8879), loss=0.4]
Epoch [42/50], Loss: 0.4911718735631728, Accuracy: 0.8534776568412781
Epoch [43/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 54.56it/s, accuracy=tensor(0.8793), loss=0.399]
Epoch [43/50], Loss: 0.48827820666973165, Accuracy: 0.8542600870132446
Epoch [44/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 54.57it/s, accuracy=tensor(0.8276), loss=0.508]
Epoch [44/50], Loss: 0.48458246507786756, Accuracy: 0.8550475835800171
Epoch [45/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 54.97it/s, accuracy=tensor(0.8276), loss=0.516]
Epoch [45/50], Loss: 0.4820603865464002, Accuracy: 0.8564545512199402
Epoch [46/50]: 100%|████████████████████████████████████| 1510/1510 [00:29<00:00, 51.96it/s, accuracy=tensor(0.8276), loss=0.539]
Epoch [46/50], Loss: 0.477130201241828, Accuracy: 0.8579027056694031
Epoch [47/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 53.94it/s, accuracy=tensor(0.8750), loss=0.479]
Epoch [47/50], Loss: 0.47574464653106713, Accuracy: 0.8578903675079346
Epoch [48/50]: 100%|████████████████████████████████████| 1510/1510 [00:28<00:00, 53.10it/s, accuracy=tensor(0.8534), loss=0.534]
Epoch [48/50], Loss: 0.4724536952790835, Accuracy: 0.8589047193527222
Epoch [49/50]: 100%|████████████████████████████████████| 1510/1510 [00:28<00:00, 52.55it/s, accuracy=tensor(0.8448), loss=0.439]
Epoch [49/50], Loss: 0.471641562119225, Accuracy: 0.8591189980506897
Epoch [50/50]: 100%|████████████████████████████████████| 1510/1510 [00:28<00:00, 52.41it/s, accuracy=tensor(0.8147), loss=0.552]
Epoch [50/50], Loss: 0.46658012089350365, Accuracy: 0.8602546453475952
-------End of Training--------
-----------------------------

------Starting Testing------
-----------------------------
Test Error:
 Accuracy: 65.69%, Avg loss: 1.6507

------End of testing--------
-----------------------------
Model saved to lstm_peptides_model.pt
Command to run for peptide generation:

python LSTM-peptides-generation.py --dataset_path ../0003d-DBAASP-Database/Database_of_Antimicrobial_Activity_and_structure_of_Peptides --model_path lstm_peptides_model.pt --output_size 22 --epochs 50 --batch_size 8 --learning_rate 0.00063 --hidden_size 256 --layers 2 --dropout 0.7 --temperature 1.0 --num_sequences 100 --min_length 2 --max_length 0 --seed WLKL
