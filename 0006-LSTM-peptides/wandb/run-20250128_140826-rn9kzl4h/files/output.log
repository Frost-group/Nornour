Using configuration: {'epochs': 50, 'batch_size': 8, 'learning_rate': 0.00063, 'layers': 2, 'output_size': 22, 'hidden_size': 256, 'dropout': 0.7}
Total peptides: 254
Training set size: 215
Test set size: 39
Max index: 21, Vocab size: 22

-------Starting Training-------
_________________________________
Epoch [1/50]: 100%|██████████████████████████████████████████| 26/26 [00:00<00:00, 61.00it/s, accuracy=tensor(0.4375), loss=1.22]
Epoch [1/50], Loss: 1.8909159165162306, Accuracy: 0.4014423191547394
Epoch [2/50]: 100%|█████████████████████████████████████████| 26/26 [00:00<00:00, 96.21it/s, accuracy=tensor(0.4375), loss=0.994]
Epoch [2/50], Loss: 1.069648300225918, Accuracy: 0.45512816309928894
Epoch [3/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 101.93it/s, accuracy=tensor(0.6042), loss=0.847]
Epoch [3/50], Loss: 0.9576520988574395, Accuracy: 0.46233972907066345
Epoch [4/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 102.62it/s, accuracy=tensor(0.4792), loss=0.867]
Epoch [4/50], Loss: 0.8968261274007651, Accuracy: 0.5080128908157349
Epoch [5/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 102.92it/s, accuracy=tensor(0.5000), loss=0.823]
Epoch [5/50], Loss: 0.8865901392239791, Accuracy: 0.5088140964508057
Epoch [6/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 104.86it/s, accuracy=tensor(0.4583), loss=0.894]
Epoch [6/50], Loss: 0.8738830502216632, Accuracy: 0.5248396396636963
Epoch [7/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 103.86it/s, accuracy=tensor(0.4792), loss=0.979]
Epoch [7/50], Loss: 0.8730776860163763, Accuracy: 0.49759620428085327
Epoch [8/50]: 100%|█████████████████████████████████████████| 26/26 [00:00<00:00, 104.67it/s, accuracy=tensor(0.6042), loss=0.87]
Epoch [8/50], Loss: 0.8527228832244873, Accuracy: 0.5176282525062561
Epoch [9/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 101.55it/s, accuracy=tensor(0.4583), loss=0.845]
Epoch [9/50], Loss: 0.8439467022052178, Accuracy: 0.5176281929016113
Epoch [10/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 103.81it/s, accuracy=tensor(0.5000), loss=0.827]
Epoch [10/50], Loss: 0.8459138984863575, Accuracy: 0.5032051801681519
Epoch [11/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 102.09it/s, accuracy=tensor(0.4792), loss=0.783]
Epoch [11/50], Loss: 0.8280377548474532, Accuracy: 0.5120192766189575
Epoch [12/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 104.04it/s, accuracy=tensor(0.5625), loss=0.811]
Epoch [12/50], Loss: 0.8377865575827085, Accuracy: 0.5152243971824646
Epoch [13/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 104.67it/s, accuracy=tensor(0.5417), loss=0.801]
Epoch [13/50], Loss: 0.826587995657554, Accuracy: 0.5312499403953552
Epoch [14/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 106.41it/s, accuracy=tensor(0.5417), loss=0.842]
Epoch [14/50], Loss: 0.8266538908848395, Accuracy: 0.5296474695205688
Epoch [15/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 104.16it/s, accuracy=tensor(0.5000), loss=0.839]
Epoch [15/50], Loss: 0.8273142071870657, Accuracy: 0.5456730723381042
Epoch [16/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 103.54it/s, accuracy=tensor(0.4167), loss=0.845]
Epoch [16/50], Loss: 0.8284122943878174, Accuracy: 0.5080128312110901
Epoch [17/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 105.97it/s, accuracy=tensor(0.5833), loss=0.844]
Epoch [17/50], Loss: 0.8215133387308854, Accuracy: 0.5296474099159241
Epoch [18/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 104.33it/s, accuracy=tensor(0.6667), loss=0.725]
Epoch [18/50], Loss: 0.8150041103363037, Accuracy: 0.528846263885498
Epoch [19/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 105.45it/s, accuracy=tensor(0.4792), loss=0.839]
Epoch [19/50], Loss: 0.819701190178211, Accuracy: 0.5264423489570618
Epoch [20/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 99.36it/s, accuracy=tensor(0.6042), loss=0.797]
Epoch [20/50], Loss: 0.8189394772052765, Accuracy: 0.526442289352417
Epoch [21/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 101.22it/s, accuracy=tensor(0.5625), loss=0.838]
Epoch [21/50], Loss: 0.8226599234801072, Accuracy: 0.5192307829856873
Epoch [22/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 98.53it/s, accuracy=tensor(0.4583), loss=0.823]
Epoch [22/50], Loss: 0.8250709359462445, Accuracy: 0.5168269276618958
Epoch [23/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 104.58it/s, accuracy=tensor(0.4583), loss=0.88]
Epoch [23/50], Loss: 0.8244503346773294, Accuracy: 0.5096153616905212
Epoch [24/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 101.44it/s, accuracy=tensor(0.5833), loss=0.825]
Epoch [24/50], Loss: 0.8284328877925873, Accuracy: 0.5016025900840759
Epoch [25/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 105.43it/s, accuracy=tensor(0.5417), loss=0.809]
Epoch [25/50], Loss: 0.8143190351816324, Accuracy: 0.5320513248443604
Epoch [26/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 103.97it/s, accuracy=tensor(0.5000), loss=0.869]
Epoch [26/50], Loss: 0.8175659225537226, Accuracy: 0.5144230127334595
Epoch [27/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 51.11it/s, accuracy=tensor(0.5625), loss=0.842]
Epoch [27/50], Loss: 0.8130598549659436, Accuracy: 0.5344551801681519
Epoch [28/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 42.71it/s, accuracy=tensor(0.4375), loss=0.868]
Epoch [28/50], Loss: 0.8188959337197818, Accuracy: 0.521634578704834
Epoch [29/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 80.07it/s, accuracy=tensor(0.5833), loss=0.816]
Epoch [29/50], Loss: 0.8141523186977093, Accuracy: 0.5408653616905212
Epoch [30/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 83.84it/s, accuracy=tensor(0.5417), loss=0.886]
Epoch [30/50], Loss: 0.8178472037498767, Accuracy: 0.53125
Epoch [31/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 100.26it/s, accuracy=tensor(0.5417), loss=0.81]
Epoch [31/50], Loss: 0.8076323798069587, Accuracy: 0.5056089758872986
Epoch [32/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 100.58it/s, accuracy=tensor(0.4375), loss=0.812]
Epoch [32/50], Loss: 0.8131134899762961, Accuracy: 0.5184293985366821
Epoch [33/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 103.81it/s, accuracy=tensor(0.6458), loss=0.896]
Epoch [33/50], Loss: 0.8062946062821609, Accuracy: 0.526442289352417
Epoch [34/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 105.33it/s, accuracy=tensor(0.5417), loss=0.816]
Epoch [34/50], Loss: 0.8110037446022034, Accuracy: 0.5208333134651184
Epoch [35/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 104.05it/s, accuracy=tensor(0.4792), loss=0.807]
Epoch [35/50], Loss: 0.8020342496725229, Accuracy: 0.5136218070983887
Epoch [36/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 105.36it/s, accuracy=tensor(0.6250), loss=0.794]
Epoch [36/50], Loss: 0.8060568295992337, Accuracy: 0.5456729531288147
Epoch [37/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 105.62it/s, accuracy=tensor(0.4583), loss=0.81]
Epoch [37/50], Loss: 0.8177674412727356, Accuracy: 0.5152243971824646
Epoch [38/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 104.82it/s, accuracy=tensor(0.5625), loss=0.771]
Epoch [38/50], Loss: 0.8090656330952277, Accuracy: 0.5280448198318481
Epoch [39/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 105.78it/s, accuracy=tensor(0.6458), loss=0.778]
Epoch [39/50], Loss: 0.8124131376926715, Accuracy: 0.5344550609588623
Epoch [40/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 105.80it/s, accuracy=tensor(0.5417), loss=0.783]
Epoch [40/50], Loss: 0.8173136642346015, Accuracy: 0.5080128908157349
Epoch [41/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 106.49it/s, accuracy=tensor(0.3958), loss=0.818]
Epoch [41/50], Loss: 0.8019585701135489, Accuracy: 0.5256410241127014
Epoch [42/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 104.20it/s, accuracy=tensor(0.4792), loss=0.876]
Epoch [42/50], Loss: 0.8091892898082733, Accuracy: 0.5160256624221802
Epoch [43/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 102.78it/s, accuracy=tensor(0.5625), loss=0.795]
Epoch [43/50], Loss: 0.8097953085715954, Accuracy: 0.5224359035491943
Epoch [44/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 80.30it/s, accuracy=tensor(0.5417), loss=0.821]
Epoch [44/50], Loss: 0.8098486799460191, Accuracy: 0.5136218667030334
Epoch [45/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 105.01it/s, accuracy=tensor(0.5000), loss=0.795]
Epoch [45/50], Loss: 0.8134421431101285, Accuracy: 0.48878204822540283
Epoch [46/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 104.84it/s, accuracy=tensor(0.5000), loss=0.85]
Epoch [46/50], Loss: 0.8019981246728164, Accuracy: 0.5104166865348816
Epoch [47/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 105.08it/s, accuracy=tensor(0.5000), loss=0.832]
Epoch [47/50], Loss: 0.8102207504785978, Accuracy: 0.5344551205635071
Epoch [48/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 104.34it/s, accuracy=tensor(0.5000), loss=0.811]
Epoch [48/50], Loss: 0.8103227431957538, Accuracy: 0.5040064454078674
Epoch [49/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 105.72it/s, accuracy=tensor(0.4375), loss=0.813]
Epoch [49/50], Loss: 0.8054063893281497, Accuracy: 0.4967948794364929
Epoch [50/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 96.22it/s, accuracy=tensor(0.5417), loss=0.804]
Epoch [50/50], Loss: 0.8050750333529252, Accuracy: 0.5224359035491943
-------End of Training--------
-----------------------------

------Starting Testing------
-----------------------------
Test Error:
 Accuracy: 32.81%, Avg loss: 1.4795

------End of testing--------
-----------------------------
Model saved to lstm_peptides_model.pt
Command to run for peptide generation:

python LSTM-peptides-generation.py --dataset_path /Users/igorgonteri/Desktop/Nornour/0003b-RW-Lexicon/RW_lexicon.dat --model_path lstm_peptides_model.pt --output_size 22 --epochs 50 --batch_size 8 --learning_rate 0.00063 --hidden_size 256 --layers 2 --dropout 0.7 --temperature 1.0 --num_sequences 100 --min_length 2 --max_length 15 --seed RWW
