Using configuration: {'epochs': 50, 'batch_size': 8, 'learning_rate': 0.00063, 'layers': 2, 'output_size': 22, 'hidden_size': 256, 'dropout': 0.7}
longest peptide: 30 AA
Size of peptides for model: 30
Total peptides: 14220
Training set size: 12087
Test set size: 2133
Max index: 21, Vocab size: 22

-------Starting Training-------
_________________________________
Epoch [1/50]: 100%|██████████████████████████████████████| 1510/1510 [00:30<00:00, 50.09it/s, accuracy=tensor(0.5733), loss=1.32]
Epoch [1/50], Loss: 1.4236750020491367, Accuracy: 0.5728477835655212
Epoch [2/50]: 100%|██████████████████████████████████████| 1510/1510 [00:27<00:00, 55.88it/s, accuracy=tensor(0.5819), loss=1.35]
Epoch [2/50], Loss: 1.255476606681647, Accuracy: 0.6203671097755432
Epoch [3/50]: 100%|██████████████████████████████████████| 1510/1510 [00:26<00:00, 56.55it/s, accuracy=tensor(0.6724), loss=1.15]
Epoch [3/50], Loss: 1.1502286394305576, Accuracy: 0.6556205153465271
Epoch [4/50]: 100%|██████████████████████████████████████| 1510/1510 [00:28<00:00, 53.80it/s, accuracy=tensor(0.6250), loss=1.13]
Epoch [4/50], Loss: 1.064050273587372, Accuracy: 0.6845144629478455
Epoch [5/50]: 100%|█████████████████████████████████████| 1510/1510 [00:27<00:00, 55.92it/s, accuracy=tensor(0.7716), loss=0.753]
Epoch [5/50], Loss: 0.9979568656311919, Accuracy: 0.7061229348182678
Epoch [6/50]: 100%|█████████████████████████████████████| 1510/1510 [00:26<00:00, 56.26it/s, accuracy=tensor(0.7672), loss=0.791]
Epoch [6/50], Loss: 0.9459118713803639, Accuracy: 0.7224107384681702
Epoch [7/50]: 100%|█████████████████████████████████████| 1510/1510 [00:28<00:00, 53.68it/s, accuracy=tensor(0.7629), loss=0.792]
Epoch [7/50], Loss: 0.904504707080639, Accuracy: 0.7355728149414062
Epoch [8/50]: 100%|█████████████████████████████████████| 1510/1510 [00:26<00:00, 56.65it/s, accuracy=tensor(0.8319), loss=0.548]
Epoch [8/50], Loss: 0.8661652627567582, Accuracy: 0.7469288110733032
Epoch [9/50]: 100%|█████████████████████████████████████| 1510/1510 [00:26<00:00, 56.49it/s, accuracy=tensor(0.7802), loss=0.728]
Epoch [9/50], Loss: 0.8344648431073751, Accuracy: 0.7561452984809875
Epoch [10/50]: 100%|█████████████████████████████████████| 1510/1510 [00:26<00:00, 56.73it/s, accuracy=tensor(0.8276), loss=0.71]
Epoch [10/50], Loss: 0.805677400756356, Accuracy: 0.7645785212516785
Epoch [11/50]: 100%|████████████████████████████████████| 1510/1510 [00:26<00:00, 57.13it/s, accuracy=tensor(0.8793), loss=0.414]
Epoch [11/50], Loss: 0.7808425578849995, Accuracy: 0.7721681594848633
Epoch [12/50]: 100%|█████████████████████████████████████| 1510/1510 [00:27<00:00, 54.27it/s, accuracy=tensor(0.7414), loss=0.87]
Epoch [12/50], Loss: 0.7595015205492247, Accuracy: 0.7785531878471375
Epoch [13/50]: 100%|████████████████████████████████████| 1510/1510 [00:26<00:00, 56.24it/s, accuracy=tensor(0.8233), loss=0.708]
Epoch [13/50], Loss: 0.7378808591736863, Accuracy: 0.7845340371131897
Epoch [14/50]: 100%|█████████████████████████████████████| 1510/1510 [00:26<00:00, 56.20it/s, accuracy=tensor(0.6940), loss=1.01]
Epoch [14/50], Loss: 0.7185238280043696, Accuracy: 0.7896890044212341
Epoch [15/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 54.73it/s, accuracy=tensor(0.7457), loss=0.942]
Epoch [15/50], Loss: 0.702658666285458, Accuracy: 0.7946650981903076
Epoch [16/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 55.48it/s, accuracy=tensor(0.8578), loss=0.516]
Epoch [16/50], Loss: 0.6854238509342371, Accuracy: 0.7990236282348633
Epoch [17/50]: 100%|████████████████████████████████████| 1510/1510 [00:26<00:00, 56.97it/s, accuracy=tensor(0.7931), loss=0.667]
Epoch [17/50], Loss: 0.6703816245328512, Accuracy: 0.8032367825508118
Epoch [18/50]: 100%|█████████████████████████████████████| 1510/1510 [00:26<00:00, 57.03it/s, accuracy=tensor(0.7802), loss=0.64]
Epoch [18/50], Loss: 0.6586847069839769, Accuracy: 0.8068951368331909
Epoch [19/50]: 100%|█████████████████████████████████████| 1510/1510 [00:26<00:00, 56.87it/s, accuracy=tensor(0.7931), loss=0.71]
Epoch [19/50], Loss: 0.643983698996487, Accuracy: 0.8108481168746948
Epoch [20/50]: 100%|████████████████████████████████████| 1510/1510 [00:29<00:00, 51.53it/s, accuracy=tensor(0.7629), loss=0.846]
Epoch [20/50], Loss: 0.6318715595449044, Accuracy: 0.8136988878250122
Epoch [21/50]: 100%|█████████████████████████████████████| 1510/1510 [00:30<00:00, 49.61it/s, accuracy=tensor(0.6681), loss=1.07]
Epoch [21/50], Loss: 0.6220395024051729, Accuracy: 0.8169251084327698
Epoch [22/50]: 100%|████████████████████████████████████| 1510/1510 [00:33<00:00, 44.89it/s, accuracy=tensor(0.8621), loss=0.519]
Epoch [22/50], Loss: 0.6117959376399881, Accuracy: 0.8197844624519348
Epoch [23/50]: 100%|████████████████████████████████████| 1510/1510 [00:31<00:00, 48.40it/s, accuracy=tensor(0.8491), loss=0.502]
Epoch [23/50], Loss: 0.6031182334320435, Accuracy: 0.8219407200813293
Epoch [24/50]: 100%|████████████████████████████████████| 1510/1510 [00:29<00:00, 50.54it/s, accuracy=tensor(0.8922), loss=0.424]
Epoch [24/50], Loss: 0.5932429214384383, Accuracy: 0.8251950740814209
Epoch [25/50]: 100%|████████████████████████████████████| 1510/1510 [00:28<00:00, 53.86it/s, accuracy=tensor(0.8448), loss=0.534]
Epoch [25/50], Loss: 0.5824804771025449, Accuracy: 0.8281174898147583
Epoch [26/50]: 100%|████████████████████████████████████| 1510/1510 [00:29<00:00, 50.67it/s, accuracy=tensor(0.8060), loss=0.665]
Epoch [26/50], Loss: 0.5766348311837936, Accuracy: 0.8291909098625183
Epoch [27/50]: 100%|████████████████████████████████████| 1510/1510 [00:26<00:00, 56.91it/s, accuracy=tensor(0.7802), loss=0.667]
Epoch [27/50], Loss: 0.5685294870706583, Accuracy: 0.831591010093689
Epoch [28/50]: 100%|████████████████████████████████████| 1510/1510 [00:26<00:00, 57.96it/s, accuracy=tensor(0.8319), loss=0.636]
Epoch [28/50], Loss: 0.5608609968265951, Accuracy: 0.8335387110710144
Epoch [29/50]: 100%|████████████████████████████████████| 1510/1510 [00:26<00:00, 57.88it/s, accuracy=tensor(0.8664), loss=0.507]
Epoch [29/50], Loss: 0.5547071189477744, Accuracy: 0.8354964256286621
Epoch [30/50]: 100%|████████████████████████████████████| 1510/1510 [00:26<00:00, 57.26it/s, accuracy=tensor(0.8922), loss=0.343]
Epoch [30/50], Loss: 0.5485641525281186, Accuracy: 0.8372181057929993
Epoch [31/50]: 100%|████████████████████████████████████| 1510/1510 [00:26<00:00, 56.69it/s, accuracy=tensor(0.8491), loss=0.559]
Epoch [31/50], Loss: 0.5423020233381662, Accuracy: 0.8389879465103149
Epoch [32/50]: 100%|████████████████████████████████████| 1510/1510 [00:28<00:00, 52.49it/s, accuracy=tensor(0.8405), loss=0.633]
Epoch [32/50], Loss: 0.534765825603182, Accuracy: 0.8410288095474243
Epoch [33/50]: 100%|████████████████████████████████████| 1510/1510 [00:26<00:00, 57.82it/s, accuracy=tensor(0.7759), loss=0.729]
Epoch [33/50], Loss: 0.5305706959291799, Accuracy: 0.8419044613838196
Epoch [34/50]: 100%|████████████████████████████████████| 1510/1510 [00:26<00:00, 57.82it/s, accuracy=tensor(0.8405), loss=0.579]
Epoch [34/50], Loss: 0.5247937144033167, Accuracy: 0.8439246416091919
Epoch [35/50]: 100%|████████████████████████████████████| 1510/1510 [00:27<00:00, 55.81it/s, accuracy=tensor(0.8147), loss=0.605]
Epoch [35/50], Loss: 0.5200027401873607, Accuracy: 0.8453083038330078
Epoch [36/50]: 100%|████████████████████████████████████| 1510/1510 [00:26<00:00, 57.90it/s, accuracy=tensor(0.8319), loss=0.621]
Epoch [36/50], Loss: 0.5155376139066077, Accuracy: 0.8465979695320129
Epoch [37/50]:  22%|████████                             | 327/1510 [00:05<00:21, 56.27it/s, accuracy=tensor(0.8276), loss=0.574]
Traceback (most recent call last):
  File "/Users/igorgonteri/Desktop/Nornour/0006-LSTM-peptides/LSTM-peptide-model.py", line 484, in <module>
    train(train_data, model)
  File "/Users/igorgonteri/Desktop/Nornour/0006-LSTM-peptides/LSTM-peptide-model.py", line 394, in train
    optimizer.step()
  File "/opt/anaconda3/envs/LLM2/lib/python3.11/site-packages/torch/optim/optimizer.py", line 373, in wrapper
    with torch.autograd.profiler.record_function(profile_name):
  File "/opt/anaconda3/envs/LLM2/lib/python3.11/site-packages/torch/autograd/profiler.py", line 622, in __exit__
    torch.ops.profiler._record_function_exit._RecordFunction(record)
  File "/opt/anaconda3/envs/LLM2/lib/python3.11/site-packages/torch/_ops.py", line 513, in __call__
    return self._op(*args, **(kwargs or {}))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
