Using configuration: {'epochs': 50, 'batch_size': 8, 'learning_rate': 0.00063, 'layers': 2, 'output_size': 22, 'hidden_size': 256, 'dropout': 0.7}
Total peptides: 254
Training set size: 215
Test set size: 39
Max index: 21, Vocab size: 22

-------Starting Training-------
_________________________________
Epoch [1/50]: 100%|██████████████████████████████████████████| 26/26 [00:00<00:00, 65.19it/s, accuracy=tensor(0.4792), loss=1.13]
Epoch [1/50], Loss: 1.9395619676663325, Accuracy: 0.3774038851261139
Epoch [2/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 103.37it/s, accuracy=tensor(0.3958), loss=0.963]
Epoch [2/50], Loss: 1.0838371790372407, Accuracy: 0.4270833730697632
Epoch [3/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 101.30it/s, accuracy=tensor(0.6250), loss=0.863]
Epoch [3/50], Loss: 0.958913885630094, Accuracy: 0.48317307233810425
Epoch [4/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 100.00it/s, accuracy=tensor(0.6875), loss=0.805]
Epoch [4/50], Loss: 0.8867650949037992, Accuracy: 0.5376602411270142
Epoch [5/50]: 100%|█████████████████████████████████████████| 26/26 [00:00<00:00, 93.76it/s, accuracy=tensor(0.4792), loss=0.923]
Epoch [5/50], Loss: 0.8715211840776297, Accuracy: 0.5200319886207581
Epoch [6/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 103.84it/s, accuracy=tensor(0.5208), loss=0.907]
Epoch [6/50], Loss: 0.8664612540831933, Accuracy: 0.5128204822540283
Epoch [7/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 100.65it/s, accuracy=tensor(0.5833), loss=0.891]
Epoch [7/50], Loss: 0.8418641823988694, Accuracy: 0.526442289352417
Epoch [8/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 103.67it/s, accuracy=tensor(0.5000), loss=0.857]
Epoch [8/50], Loss: 0.8467941811451545, Accuracy: 0.5192307233810425
Epoch [9/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 101.53it/s, accuracy=tensor(0.5208), loss=0.855]
Epoch [9/50], Loss: 0.8603627498333271, Accuracy: 0.5176281929016113
Epoch [10/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 102.99it/s, accuracy=tensor(0.5000), loss=0.86]
Epoch [10/50], Loss: 0.8608932884839865, Accuracy: 0.5072115659713745
Epoch [11/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 103.29it/s, accuracy=tensor(0.5208), loss=0.834]
Epoch [11/50], Loss: 0.8507461341527792, Accuracy: 0.5128204822540283
Epoch [12/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 102.19it/s, accuracy=tensor(0.4583), loss=0.861]
Epoch [12/50], Loss: 0.8495689217860882, Accuracy: 0.5280448794364929
Epoch [13/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 101.73it/s, accuracy=tensor(0.5417), loss=0.823]
Epoch [13/50], Loss: 0.8381209533948165, Accuracy: 0.5088140964508057
Epoch [14/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 103.38it/s, accuracy=tensor(0.5000), loss=0.826]
Epoch [14/50], Loss: 0.8332583010196686, Accuracy: 0.5224359035491943
Epoch [15/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 65.23it/s, accuracy=tensor(0.6042), loss=0.766]
Epoch [15/50], Loss: 0.8380250288889959, Accuracy: 0.5096153616905212
Epoch [16/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 83.13it/s, accuracy=tensor(0.5000), loss=0.857]
Epoch [16/50], Loss: 0.8312668066758376, Accuracy: 0.4967949092388153
Epoch [17/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 102.45it/s, accuracy=tensor(0.4375), loss=0.834]
Epoch [17/50], Loss: 0.8234855349247272, Accuracy: 0.5032051801681519
Epoch [18/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 105.70it/s, accuracy=tensor(0.4792), loss=0.819]
Epoch [18/50], Loss: 0.826387508557393, Accuracy: 0.5352565050125122
Epoch [19/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 103.86it/s, accuracy=tensor(0.4583), loss=0.806]
Epoch [19/50], Loss: 0.8375292695485629, Accuracy: 0.5136217474937439
Epoch [20/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 101.44it/s, accuracy=tensor(0.3958), loss=0.886]
Epoch [20/50], Loss: 0.8364532773311322, Accuracy: 0.5056089758872986
Epoch [21/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 104.87it/s, accuracy=tensor(0.5000), loss=0.812]
Epoch [21/50], Loss: 0.8244990270871383, Accuracy: 0.4919871687889099
Epoch [22/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 105.57it/s, accuracy=tensor(0.4583), loss=0.801]
Epoch [22/50], Loss: 0.8249251980047959, Accuracy: 0.5224359035491943
Epoch [23/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 103.54it/s, accuracy=tensor(0.5000), loss=0.819]
Epoch [23/50], Loss: 0.8220207874591534, Accuracy: 0.5112179517745972
Epoch [24/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 105.46it/s, accuracy=tensor(0.5833), loss=0.791]
Epoch [24/50], Loss: 0.8070004903353177, Accuracy: 0.5144230723381042
Epoch [25/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 104.20it/s, accuracy=tensor(0.5833), loss=0.772]
Epoch [25/50], Loss: 0.8192223768967849, Accuracy: 0.5200320482254028
Epoch [26/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 105.81it/s, accuracy=tensor(0.5417), loss=0.824]
Epoch [26/50], Loss: 0.8104054904901065, Accuracy: 0.5320513248443604
Epoch [27/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 96.10it/s, accuracy=tensor(0.4375), loss=0.832]
Epoch [27/50], Loss: 0.8160310937808111, Accuracy: 0.504807710647583
Epoch [28/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 100.65it/s, accuracy=tensor(0.5625), loss=0.808]
Epoch [28/50], Loss: 0.8130692702073318, Accuracy: 0.5312499403953552
Epoch [29/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 102.87it/s, accuracy=tensor(0.5625), loss=0.795]
Epoch [29/50], Loss: 0.813681939473519, Accuracy: 0.5256410241127014
Epoch [30/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 105.47it/s, accuracy=tensor(0.5208), loss=0.824]
Epoch [30/50], Loss: 0.8095810505060049, Accuracy: 0.5176282525062561
Epoch [31/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 103.05it/s, accuracy=tensor(0.4583), loss=0.835]
Epoch [31/50], Loss: 0.8147161534199348, Accuracy: 0.5304486751556396
Epoch [32/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 105.71it/s, accuracy=tensor(0.5000), loss=0.837]
Epoch [32/50], Loss: 0.8231283311660473, Accuracy: 0.516826868057251
Epoch [33/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 102.66it/s, accuracy=tensor(0.5833), loss=0.758]
Epoch [33/50], Loss: 0.8150151188556964, Accuracy: 0.5272435545921326
Epoch [34/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 103.36it/s, accuracy=tensor(0.4792), loss=0.832]
Epoch [34/50], Loss: 0.8129000755456778, Accuracy: 0.5040064454078674
Epoch [35/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 103.31it/s, accuracy=tensor(0.5417), loss=0.806]
Epoch [35/50], Loss: 0.8066226977568406, Accuracy: 0.5424679517745972
Epoch [36/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 104.85it/s, accuracy=tensor(0.5625), loss=0.757]
Epoch [36/50], Loss: 0.8128074911924509, Accuracy: 0.5200320482254028
Epoch [37/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 103.52it/s, accuracy=tensor(0.5833), loss=0.765]
Epoch [37/50], Loss: 0.8062400634472187, Accuracy: 0.5248396992683411
Epoch [38/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 104.34it/s, accuracy=tensor(0.5625), loss=0.849]
Epoch [38/50], Loss: 0.80992447412931, Accuracy: 0.5184295177459717
Epoch [39/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 104.08it/s, accuracy=tensor(0.5000), loss=0.826]
Epoch [39/50], Loss: 0.8127568226594192, Accuracy: 0.5192307829856873
Epoch [40/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 103.83it/s, accuracy=tensor(0.5833), loss=0.835]
Epoch [40/50], Loss: 0.8182560709806589, Accuracy: 0.5056089758872986
Epoch [41/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 106.50it/s, accuracy=tensor(0.5833), loss=0.809]
Epoch [41/50], Loss: 0.8073504521296575, Accuracy: 0.5280448198318481
Epoch [42/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 102.78it/s, accuracy=tensor(0.6458), loss=0.788]
Epoch [42/50], Loss: 0.803566228884917, Accuracy: 0.5280448198318481
Epoch [43/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 100.98it/s, accuracy=tensor(0.5417), loss=0.805]
Epoch [43/50], Loss: 0.7969838334963872, Accuracy: 0.5376602411270142
Epoch [44/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 103.40it/s, accuracy=tensor(0.5625), loss=0.79]
Epoch [44/50], Loss: 0.8087239586389982, Accuracy: 0.5192307829856873
Epoch [45/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 99.10it/s, accuracy=tensor(0.5417), loss=0.787]
Epoch [45/50], Loss: 0.7924271776125982, Accuracy: 0.5312499403953552
Epoch [46/50]: 100%|████████████████████████████████████████| 26/26 [00:00<00:00, 98.12it/s, accuracy=tensor(0.4792), loss=0.841]
Epoch [46/50], Loss: 0.8096371591091156, Accuracy: 0.5240384936332703
Epoch [47/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 104.14it/s, accuracy=tensor(0.5208), loss=0.777]
Epoch [47/50], Loss: 0.8071482158624209, Accuracy: 0.5120192170143127
Epoch [48/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 104.79it/s, accuracy=tensor(0.6667), loss=0.826]
Epoch [48/50], Loss: 0.8105095120576712, Accuracy: 0.514423131942749
Epoch [49/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 105.91it/s, accuracy=tensor(0.5208), loss=0.833]
Epoch [49/50], Loss: 0.8068997676555927, Accuracy: 0.5176281929016113
Epoch [50/50]: 100%|███████████████████████████████████████| 26/26 [00:00<00:00, 104.20it/s, accuracy=tensor(0.4792), loss=0.789]
Epoch [50/50], Loss: 0.8096509690468128, Accuracy: 0.5008012652397156
-------End of Training--------
-----------------------------

------Starting Testing------
-----------------------------
Test Error:
 Accuracy: 31.77%, Avg loss: 1.3519

------End of testing--------
-----------------------------
Model saved to lstm_peptides_model.pt
Command to run for peptide generation:

python LSTM-peptides-generation.py --dataset_path /Users/igorgonteri/Desktop/Nornour/0003b-RW-Lexicon/RW_lexicon.dat --model_path lstm_peptides_model.pt --output_path generation_output.fasta --output_size 22 --epochs 50 --batch_size 8 --learning_rate 0.00063 --hidden_size 256 --layers 2 --dropout 0.7 --temperature 1.0 --num_sequences 100 --min_length 2 --max_length 15 --seed RWW
