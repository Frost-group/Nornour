Using configuration: {'epochs': 50, 'batch_size': 16, 'learning_rate': 0.00063, 'layers': 2, 'output_size': 21, 'hidden_size': 256, 'dropout': 0.7}
longest peptide: 30 AA
Size of peptides for model: 15
Total peptides: 14220
Training set size: 12087
Test set size: 2133
Max index: 20, Vocab size: 21

-------Starting Training-------
_________________________________
Epoch [1/50]: 100%|██████████████████████████████████████████████████████| 755/755 [00:05<00:00, 131.34it/s, accuracy=tensor(0.3616), loss=2.19]
Epoch [1/50], Loss: 2.2461149289908, Accuracy: 0.32038187980651855
Epoch [2/50]: 100%|██████████████████████████████████████████████████████| 755/755 [00:07<00:00, 106.82it/s, accuracy=tensor(0.3438), loss=2.07]
Epoch [2/50], Loss: 2.011466807245419, Accuracy: 0.3900010585784912
Epoch [3/50]: 100%|██████████████████████████████████████████████████████| 755/755 [00:07<00:00, 101.08it/s, accuracy=tensor(0.4196), loss=1.91]
Epoch [3/50], Loss: 1.8763456721968998, Accuracy: 0.4345078766345978
Epoch [4/50]: 100%|██████████████████████████████████████████████████████| 755/755 [00:07<00:00, 100.90it/s, accuracy=tensor(0.4509), loss=1.94]
Epoch [4/50], Loss: 1.7591046990148278, Accuracy: 0.47643715143203735
Epoch [5/50]: 100%|████████████████████████████████████████████████████████| 755/755 [00:07<00:00, 96.12it/s, accuracy=tensor(0.5223), loss=1.6]
Epoch [5/50], Loss: 1.6554849076744735, Accuracy: 0.510525107383728
Epoch [6/50]: 100%|██████████████████████████████████████████████████████| 755/755 [00:07<00:00, 104.48it/s, accuracy=tensor(0.4866), loss=1.82]
Epoch [6/50], Loss: 1.571087409644727, Accuracy: 0.5371808409690857
Epoch [7/50]: 100%|██████████████████████████████████████████████████████| 755/755 [00:07<00:00, 103.13it/s, accuracy=tensor(0.5625), loss=1.47]
Epoch [7/50], Loss: 1.5019764556000563, Accuracy: 0.5593488216400146
Epoch [8/50]: 100%|██████████████████████████████████████████████████████| 755/755 [00:07<00:00, 103.48it/s, accuracy=tensor(0.6250), loss=1.26]
Epoch [8/50], Loss: 1.440630655730797, Accuracy: 0.5778385400772095
Epoch [9/50]: 100%|████████████████████████████████████████████████████████| 755/755 [00:08<00:00, 92.74it/s, accuracy=tensor(0.5848), loss=1.4]
Epoch [9/50], Loss: 1.3890811748852003, Accuracy: 0.5928453803062439
Epoch [10/50]: 100%|█████████████████████████████████████████████████████| 755/755 [00:07<00:00, 106.29it/s, accuracy=tensor(0.6518), loss=1.19]
Epoch [10/50], Loss: 1.3420368148001613, Accuracy: 0.6064391136169434
Epoch [11/50]: 100%|██████████████████████████████████████████████████████| 755/755 [00:07<00:00, 105.44it/s, accuracy=tensor(0.6161), loss=1.3]
Epoch [11/50], Loss: 1.298658026685778, Accuracy: 0.619353711605072
Epoch [12/50]: 100%|█████████████████████████████████████████████████████| 755/755 [00:07<00:00, 107.23it/s, accuracy=tensor(0.6786), loss=1.16]
Epoch [12/50], Loss: 1.26140674486855, Accuracy: 0.6301148533821106
Epoch [13/50]: 100%|█████████████████████████████████████████████████████| 755/755 [00:07<00:00, 105.77it/s, accuracy=tensor(0.7098), loss=1.04]
Epoch [13/50], Loss: 1.2265915003833392, Accuracy: 0.6410536766052246
Epoch [14/50]: 100%|██████████████████████████████████████████████████████| 755/755 [00:07<00:00, 106.75it/s, accuracy=tensor(0.6964), loss=1.1]
Epoch [14/50], Loss: 1.1919443605751392, Accuracy: 0.6504787802696228
Epoch [15/50]: 100%|█████████████████████████████████████████████████████| 755/755 [00:06<00:00, 109.31it/s, accuracy=tensor(0.6518), loss=1.27]
Epoch [15/50], Loss: 1.16237923104242, Accuracy: 0.6586508750915527
Epoch [16/50]: 100%|█████████████████████████████████████████████████████| 755/755 [00:06<00:00, 108.10it/s, accuracy=tensor(0.6161), loss=1.23]
Epoch [16/50], Loss: 1.1337753441160088, Accuracy: 0.6664086580276489
Epoch [17/50]: 100%|█████████████████████████████████████████████████████| 755/755 [00:06<00:00, 109.63it/s, accuracy=tensor(0.6741), loss=1.06]
Epoch [17/50], Loss: 1.1079580702529048, Accuracy: 0.6744915246963501
Epoch [18/50]: 100%|█████████████████████████████████████████████████████| 755/755 [00:06<00:00, 108.34it/s, accuracy=tensor(0.7500), loss=1.02]
Epoch [18/50], Loss: 1.084699373845233, Accuracy: 0.6805700659751892
Epoch [19/50]: 100%|█████████████████████████████████████████████████████| 755/755 [00:06<00:00, 109.39it/s, accuracy=tensor(0.6964), loss=1.07]
Epoch [19/50], Loss: 1.0617687213499813, Accuracy: 0.687008798122406
Epoch [20/50]: 100%|█████████████████████████████████████████████████████| 755/755 [00:06<00:00, 108.74it/s, accuracy=tensor(0.6964), loss=1.05]
Epoch [20/50], Loss: 1.0412830306994205, Accuracy: 0.6924903392791748
Epoch [21/50]: 100%|████████████████████████████████████████████████████| 755/755 [00:06<00:00, 109.25it/s, accuracy=tensor(0.7411), loss=0.962]
Epoch [21/50], Loss: 1.0228562912404142, Accuracy: 0.6978415250778198
Epoch [22/50]: 100%|██████████████████████████████████████████████████████| 755/755 [00:07<00:00, 107.09it/s, accuracy=tensor(0.6518), loss=1.1]
Epoch [22/50], Loss: 1.0062248411557533, Accuracy: 0.7015548944473267
Epoch [23/50]: 100%|█████████████████████████████████████████████████████| 755/755 [00:06<00:00, 108.42it/s, accuracy=tensor(0.6339), loss=1.29]
Epoch [23/50], Loss: 0.9874541240022672, Accuracy: 0.708000123500824
Epoch [24/50]: 100%|█████████████████████████████████████████████████████| 755/755 [00:07<00:00, 107.72it/s, accuracy=tensor(0.6607), loss=1.06]
Epoch [24/50], Loss: 0.9697478876208627, Accuracy: 0.7129082679748535
Epoch [25/50]: 100%|████████████████████████████████████████████████████| 755/755 [00:07<00:00, 107.42it/s, accuracy=tensor(0.6964), loss=0.972]
Epoch [25/50], Loss: 0.9587326235329079, Accuracy: 0.715657651424408
Epoch [26/50]: 100%|████████████████████████████████████████████████████| 755/755 [00:07<00:00, 104.62it/s, accuracy=tensor(0.7321), loss=0.946]
Epoch [26/50], Loss: 0.943889339870175, Accuracy: 0.7200629711151123
Epoch [27/50]: 100%|████████████████████████████████████████████████████| 755/755 [00:06<00:00, 108.20it/s, accuracy=tensor(0.7812), loss=0.831]
Epoch [27/50], Loss: 0.9298542674803576, Accuracy: 0.723285436630249
Epoch [28/50]: 100%|████████████████████████████████████████████████████| 755/755 [00:07<00:00, 105.44it/s, accuracy=tensor(0.6875), loss=0.975]
Epoch [28/50], Loss: 0.9167028901592785, Accuracy: 0.726696789264679
Epoch [29/50]: 100%|████████████████████████████████████████████████████| 755/755 [00:07<00:00, 106.39it/s, accuracy=tensor(0.7143), loss=0.894]
Epoch [29/50], Loss: 0.907767150654698, Accuracy: 0.7309960722923279
Epoch [30/50]: 100%|████████████████████████████████████████████████████| 755/755 [00:07<00:00, 104.72it/s, accuracy=tensor(0.7009), loss=0.913]
Epoch [30/50], Loss: 0.8960095772680068, Accuracy: 0.7334849238395691
Epoch [31/50]: 100%|████████████████████████████████████████████████████| 755/755 [00:07<00:00, 105.13it/s, accuracy=tensor(0.7321), loss=0.971]
Epoch [31/50], Loss: 0.887087412227858, Accuracy: 0.7354184985160828
Epoch [32/50]: 100%|█████████████████████████████████████████████████████| 755/755 [00:07<00:00, 105.41it/s, accuracy=tensor(0.7277), loss=0.89]
Epoch [32/50], Loss: 0.8747072621686569, Accuracy: 0.7387886643409729
Epoch [33/50]: 100%|████████████████████████████████████████████████████| 755/755 [00:07<00:00, 105.46it/s, accuracy=tensor(0.7277), loss=0.871]
Epoch [33/50], Loss: 0.8687767882220793, Accuracy: 0.7408819794654846
Epoch [34/50]: 100%|████████████████████████████████████████████████████| 755/755 [00:07<00:00, 107.16it/s, accuracy=tensor(0.7812), loss=0.793]
Epoch [34/50], Loss: 0.8590588703850247, Accuracy: 0.7434833645820618
Epoch [35/50]: 100%|██████████████████████████████████████████████████████| 755/755 [00:07<00:00, 102.27it/s, accuracy=tensor(0.7277), loss=0.8]
Epoch [35/50], Loss: 0.8505889496266447, Accuracy: 0.7464286088943481
Epoch [36/50]: 100%|████████████████████████████████████████████████████| 755/755 [00:07<00:00, 107.59it/s, accuracy=tensor(0.7768), loss=0.736]
Epoch [36/50], Loss: 0.8457221027241637, Accuracy: 0.7473626136779785
Epoch [37/50]: 100%|████████████████████████████████████████████████████| 755/755 [00:07<00:00, 106.08it/s, accuracy=tensor(0.7679), loss=0.864]
Epoch [37/50], Loss: 0.8370387724693248, Accuracy: 0.7496874928474426
Epoch [38/50]: 100%|████████████████████████████████████████████████████| 755/755 [00:07<00:00, 106.77it/s, accuracy=tensor(0.7812), loss=0.824]
Epoch [38/50], Loss: 0.8298590260625675, Accuracy: 0.7525362968444824
Epoch [39/50]: 100%|████████████████████████████████████████████████████| 755/755 [00:07<00:00, 106.79it/s, accuracy=tensor(0.7634), loss=0.801]
Epoch [39/50], Loss: 0.8250512686786272, Accuracy: 0.7532519102096558
Epoch [40/50]: 100%|████████████████████████████████████████████████████| 755/755 [00:06<00:00, 108.34it/s, accuracy=tensor(0.7500), loss=0.907]
Epoch [40/50], Loss: 0.8197548520486087, Accuracy: 0.7548720836639404
Epoch [41/50]: 100%|████████████████████████████████████████████████████| 755/755 [00:07<00:00, 106.67it/s, accuracy=tensor(0.7723), loss=0.808]
Epoch [41/50], Loss: 0.8144729072684483, Accuracy: 0.7566459774971008
Epoch [42/50]: 100%|█████████████████████████████████████████████████████| 755/755 [00:06<00:00, 108.15it/s, accuracy=tensor(0.7500), loss=0.84]
Epoch [42/50], Loss: 0.8086545240010646, Accuracy: 0.7583786249160767
Epoch [43/50]: 100%|████████████████████████████████████████████████████| 755/755 [00:07<00:00, 106.08it/s, accuracy=tensor(0.7455), loss=0.878]
Epoch [43/50], Loss: 0.8014891324453796, Accuracy: 0.759425699710846
Epoch [44/50]: 100%|████████████████████████████████████████████████████| 755/755 [00:06<00:00, 108.35it/s, accuracy=tensor(0.7455), loss=0.826]
Epoch [44/50], Loss: 0.7965998184601992, Accuracy: 0.7612998485565186
Epoch [45/50]: 100%|████████████████████████████████████████████████████| 755/755 [00:07<00:00, 106.40it/s, accuracy=tensor(0.7232), loss=0.913]
Epoch [45/50], Loss: 0.7977200355750835, Accuracy: 0.761376142501831
Epoch [46/50]: 100%|████████████████████████████████████████████████████████| 755/755 [00:07<00:00, 107.38it/s, accuracy=tensor(0.6830), loss=1]
Epoch [46/50], Loss: 0.7910966516330542, Accuracy: 0.7627252340316772
Epoch [47/50]: 100%|█████████████████████████████████████████████████████| 755/755 [00:07<00:00, 105.60it/s, accuracy=tensor(0.7545), loss=0.86]
Epoch [47/50], Loss: 0.7845866436200426, Accuracy: 0.7638958096504211
Epoch [48/50]: 100%|████████████████████████████████████████████████████| 755/755 [00:07<00:00, 105.65it/s, accuracy=tensor(0.7902), loss=0.716]
Epoch [48/50], Loss: 0.7800453785239466, Accuracy: 0.766508936882019
Epoch [49/50]: 100%|████████████████████████████████████████████████████| 755/755 [00:07<00:00, 105.99it/s, accuracy=tensor(0.7768), loss=0.767]
Epoch [49/50], Loss: 0.7783626355082783, Accuracy: 0.7661003470420837
Epoch [50/50]: 100%|████████████████████████████████████████████████████| 755/755 [00:07<00:00, 105.19it/s, accuracy=tensor(0.7946), loss=0.793]
Epoch [50/50], Loss: 0.7746615521955175, Accuracy: 0.7682822346687317
-------End of Training--------
-----------------------------
Traceback (most recent call last):
  File "/Users/gonterigor/Documents/Imperial/Research/Nornour/0006-LSTM-peptides/scripts/LSTM-peptide-model.py", line 460, in <module>
    avg_epoch_loss, avg_epoch_accuracy = train(train_data, model)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gonterigor/Documents/Imperial/Research/Nornour/0006-LSTM-peptides/scripts/LSTM-peptide-model.py", line 384, in train
    return round(avg_epoch_loss.item(), 6), round(avg_epoch_accuracy.item(), 4)
                 ^^^^^^^^^^^^^^^^^^^
AttributeError: 'float' object has no attribute 'item'
