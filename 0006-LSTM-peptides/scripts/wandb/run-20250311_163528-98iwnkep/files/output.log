Using configuration: {'epochs': 100, 'batch_size': 8, 'learning_rate': 0.00063, 'layers': 2, 'output_size': 21, 'hidden_size': 256, 'dropout': 0.7}
longest peptide: 30 AA
Size of peptides for model: 15
Total peptides: 14220
Training set size: 12087
Test set size: 2133
Max index: 20, Vocab size: 21

-------Starting Training-------
_________________________________
Epoch [1/100]: 100%|███████████████████████████████████████████████████| 1510/1510 [00:08<00:00, 177.75it/s, accuracy=tensor(0.2500), loss=2.33]
Epoch [1/100], Loss: 2.196167542839682, Accuracy: 0.33364489674568176
Epoch [2/100]: 100%|███████████████████████████████████████████████████| 1510/1510 [00:08<00:00, 171.94it/s, accuracy=tensor(0.4107), loss=2.13]
Epoch [2/100], Loss: 1.9501502944144191, Accuracy: 0.4118141829967499
Epoch [3/100]: 100%|████████████████████████████████████████████████████| 1510/1510 [00:08<00:00, 172.90it/s, accuracy=tensor(0.4821), loss=1.8]
Epoch [3/100], Loss: 1.7930201738085967, Accuracy: 0.46424418687820435
Epoch [4/100]: 100%|███████████████████████████████████████████████████| 1510/1510 [00:09<00:00, 166.32it/s, accuracy=tensor(0.4911), loss=1.74]
Epoch [4/100], Loss: 1.67021753819573, Accuracy: 0.5042754411697388
Epoch [5/100]: 100%|████████████████████████████████████████████████████| 1510/1510 [00:09<00:00, 164.63it/s, accuracy=tensor(0.5357), loss=1.7]
Epoch [5/100], Loss: 1.57547741583641, Accuracy: 0.5355842113494873
Epoch [6/100]: 100%|███████████████████████████████████████████████████| 1510/1510 [00:09<00:00, 164.38it/s, accuracy=tensor(0.4643), loss=1.64]
Epoch [6/100], Loss: 1.499104621197214, Accuracy: 0.5588407516479492
Epoch [7/100]: 100%|███████████████████████████████████████████████████| 1510/1510 [00:09<00:00, 161.58it/s, accuracy=tensor(0.5714), loss=1.56]
Epoch [7/100], Loss: 1.430558690408997, Accuracy: 0.5799436569213867
Epoch [8/100]: 100%|███████████████████████████████████████████████████| 1510/1510 [00:09<00:00, 159.99it/s, accuracy=tensor(0.6071), loss=1.28]
Epoch [8/100], Loss: 1.3768195563594237, Accuracy: 0.5971442461013794
Epoch [9/100]: 100%|███████████████████████████████████████████████████| 1510/1510 [00:09<00:00, 154.24it/s, accuracy=tensor(0.6696), loss=1.15]
Epoch [9/100], Loss: 1.332156875709824, Accuracy: 0.6095374226570129
Epoch [10/100]: 100%|█████████████████████████████████████████████████| 1510/1510 [00:09<00:00, 152.36it/s, accuracy=tensor(0.7946), loss=0.776]
Epoch [10/100], Loss: 1.2852812523873436, Accuracy: 0.6228004097938538
Epoch [11/100]: 100%|██████████████████████████████████████████████████| 1510/1510 [00:10<00:00, 149.09it/s, accuracy=tensor(0.5536), loss=1.39]
Epoch [11/100], Loss: 1.2469243425407157, Accuracy: 0.6341059803962708
Epoch [12/100]: 100%|███████████████████████████████████████████████████| 1510/1510 [00:09<00:00, 154.21it/s, accuracy=tensor(0.5714), loss=1.6]
Epoch [12/100], Loss: 1.2121614968145131, Accuracy: 0.643519937992096
Epoch [13/100]: 100%|██████████████████████████████████████████████████| 1510/1510 [00:09<00:00, 151.36it/s, accuracy=tensor(0.6250), loss=1.13]
Epoch [13/100], Loss: 1.1802466236202922, Accuracy: 0.6525894403457642
Epoch [14/100]: 100%|█████████████████████████████████████████████████| 1510/1510 [00:09<00:00, 151.79it/s, accuracy=tensor(0.7679), loss=0.929]
Epoch [14/100], Loss: 1.1500841156931112, Accuracy: 0.6604016423225403
Epoch [15/100]: 100%|██████████████████████████████████████████████████| 1510/1510 [00:10<00:00, 150.80it/s, accuracy=tensor(0.6161), loss=1.32]
Epoch [15/100], Loss: 1.1224866151020227, Accuracy: 0.6687382459640503
Epoch [16/100]: 100%|██████████████████████████████████████████████████| 1510/1510 [00:10<00:00, 149.39it/s, accuracy=tensor(0.5357), loss=1.46]
Epoch [16/100], Loss: 1.0983537443821003, Accuracy: 0.6751002073287964
Epoch [17/100]: 100%|██████████████████████████████████████████████████| 1510/1510 [00:10<00:00, 149.38it/s, accuracy=tensor(0.7946), loss=0.81]
Epoch [17/100], Loss: 1.075720669931134, Accuracy: 0.6821901798248291
Epoch [18/100]: 100%|██████████████████████████████████████████████████| 1510/1510 [00:10<00:00, 149.46it/s, accuracy=tensor(0.6696), loss=1.12]
Epoch [18/100], Loss: 1.0522514739573396, Accuracy: 0.6893863677978516
Epoch [19/100]: 100%|██████████████████████████████████████████████████| 1510/1510 [00:10<00:00, 143.26it/s, accuracy=tensor(0.5446), loss=1.45]
Epoch [19/100], Loss: 1.0320036720755874, Accuracy: 0.6944417357444763
Epoch [20/100]: 100%|█████████████████████████████████████████████████| 1510/1510 [00:11<00:00, 135.92it/s, accuracy=tensor(0.7143), loss=0.929]
Epoch [20/100], Loss: 1.0154358631727711, Accuracy: 0.6992968320846558
Epoch [21/100]: 100%|██████████████████████████████████████████████████| 1510/1510 [00:12<00:00, 116.63it/s, accuracy=tensor(0.6786), loss=1.36]
Epoch [21/100], Loss: 0.998183435083225, Accuracy: 0.7031872272491455
Epoch [22/100]: 100%|██████████████████████████████████████████████████| 1510/1510 [00:15<00:00, 95.25it/s, accuracy=tensor(0.7321), loss=0.739]
Epoch [22/100], Loss: 0.9817567001904873, Accuracy: 0.7076155543327332
Epoch [23/100]: 100%|██████████████████████████████████████████████████| 1510/1510 [00:14<00:00, 106.42it/s, accuracy=tensor(0.6339), loss=1.19]
Epoch [23/100], Loss: 0.9670484056535935, Accuracy: 0.7115713953971863
Epoch [24/100]: 100%|██████████████████████████████████████████████████| 1510/1510 [00:14<00:00, 107.43it/s, accuracy=tensor(0.6786), loss=1.04]
Epoch [24/100], Loss: 0.9523478084842101, Accuracy: 0.7159947156906128
Epoch [25/100]: 100%|█████████████████████████████████████████████████| 1510/1510 [00:13<00:00, 110.62it/s, accuracy=tensor(0.6964), loss=0.994]
Epoch [25/100], Loss: 0.9385972973526708, Accuracy: 0.7203238010406494
Epoch [26/100]: 100%|█████████████████████████████████████████████████| 1510/1510 [00:13<00:00, 115.74it/s, accuracy=tensor(0.7232), loss=0.932]
Epoch [26/100], Loss: 0.9283855250734367, Accuracy: 0.7234387397766113
Epoch [27/100]: 100%|█████████████████████████████████████████████████| 1510/1510 [00:12<00:00, 125.31it/s, accuracy=tensor(0.7679), loss=0.732]
Epoch [27/100], Loss: 0.9169259915683443, Accuracy: 0.7258807420730591
Epoch [28/100]: 100%|█████████████████████████████████████████████████| 1510/1510 [00:11<00:00, 128.72it/s, accuracy=tensor(0.7143), loss=0.848]
Epoch [28/100], Loss: 0.9035265943467222, Accuracy: 0.7299847602844238
Epoch [29/100]: 100%|█████████████████████████████████████████████████| 1510/1510 [00:11<00:00, 128.01it/s, accuracy=tensor(0.7321), loss=0.939]
Epoch [29/100], Loss: 0.899176481070108, Accuracy: 0.7305337190628052
Epoch [30/100]: 100%|█████████████████████████████████████████████████| 1510/1510 [00:11<00:00, 128.04it/s, accuracy=tensor(0.7321), loss=0.889]
Epoch [30/100], Loss: 0.8900307589019372, Accuracy: 0.7334145903587341
Epoch [31/100]: 100%|█████████████████████████████████████████████████| 1510/1510 [00:12<00:00, 125.72it/s, accuracy=tensor(0.7054), loss=0.843]
Epoch [31/100], Loss: 0.8799642028792805, Accuracy: 0.7369917631149292
Epoch [32/100]: 100%|█████████████████████████████████████████████████| 1510/1510 [00:11<00:00, 126.27it/s, accuracy=tensor(0.7500), loss=0.884]
Epoch [32/100], Loss: 0.8717159246372072, Accuracy: 0.7387948632240295
Epoch [33/100]: 100%|█████████████████████████████████████████████████| 1510/1510 [00:11<00:00, 131.51it/s, accuracy=tensor(0.8214), loss=0.711]
Epoch [33/100], Loss: 0.8635958180522287, Accuracy: 0.7418460845947266
Epoch [34/100]: 100%|█████████████████████████████████████████████████| 1510/1510 [00:11<00:00, 130.49it/s, accuracy=tensor(0.8036), loss=0.742]
Epoch [34/100], Loss: 0.8572768426099361, Accuracy: 0.7426791787147522
Epoch [35/100]: 100%|█████████████████████████████████████████████████| 1510/1510 [00:11<00:00, 130.68it/s, accuracy=tensor(0.7589), loss=0.676]
Epoch [35/100], Loss: 0.849206310155376, Accuracy: 0.7453696727752686
Epoch [36/100]: 100%|█████████████████████████████████████████████████| 1510/1510 [00:11<00:00, 129.89it/s, accuracy=tensor(0.7679), loss=0.823]
Epoch [36/100], Loss: 0.8426233294783838, Accuracy: 0.7462864518165588
Epoch [37/100]: 100%|█████████████████████████████████████████████████| 1510/1510 [00:11<00:00, 129.80it/s, accuracy=tensor(0.7768), loss=0.794]
Epoch [37/100], Loss: 0.835083357585187, Accuracy: 0.7490595579147339
Epoch [38/100]: 100%|█████████████████████████████████████████████████| 1510/1510 [00:11<00:00, 130.62it/s, accuracy=tensor(0.7411), loss=0.848]
Epoch [38/100], Loss: 0.8309701139169023, Accuracy: 0.7507383823394775
Epoch [39/100]: 100%|██████████████████████████████████████████████████| 1510/1510 [00:11<00:00, 131.81it/s, accuracy=tensor(0.7768), loss=0.81]
Epoch [39/100], Loss: 0.8285152368198168, Accuracy: 0.7509574294090271
Epoch [40/100]: 100%|█████████████████████████████████████████████████| 1510/1510 [00:11<00:00, 130.64it/s, accuracy=tensor(0.6696), loss=0.915]
Epoch [40/100], Loss: 0.822892733954436, Accuracy: 0.7533518671989441
Epoch [41/100]: 100%|██████████████████████████████████████████████████| 1510/1510 [00:11<00:00, 129.50it/s, accuracy=tensor(0.6964), loss=1.01]
Epoch [41/100], Loss: 0.8185430132000652, Accuracy: 0.7531158924102783
Epoch [42/100]: 100%|█████████████████████████████████████████████████████| 1510/1510 [00:12<00:00, 120.50it/s, accuracy=tensor(0.6964), loss=1]
Epoch [42/100], Loss: 0.8108677554998966, Accuracy: 0.7565155625343323
Epoch [43/100]: 100%|█████████████████████████████████████████████████| 1510/1510 [00:12<00:00, 121.13it/s, accuracy=tensor(0.7768), loss=0.742]
Epoch [43/100], Loss: 0.8081219379080842, Accuracy: 0.757089376449585
Epoch [44/100]: 100%|██████████████████████████████████████████████████| 1510/1510 [00:12<00:00, 122.94it/s, accuracy=tensor(0.6696), loss=1.03]
Epoch [44/100], Loss: 0.8030976673033063, Accuracy: 0.7567583322525024
Epoch [45/100]: 100%|█████████████████████████████████████████████████| 1510/1510 [00:12<00:00, 121.25it/s, accuracy=tensor(0.6964), loss=0.968]
Epoch [45/100], Loss: 0.8008805650354222, Accuracy: 0.7588987350463867
Epoch [46/100]: 100%|██████████████████████████████████████████████████| 1510/1510 [00:15<00:00, 95.38it/s, accuracy=tensor(0.7143), loss=0.861]
Epoch [46/100], Loss: 0.7979596696547325, Accuracy: 0.7590289115905762
Epoch [47/100]:  62%|███████████████████████████████▋                   | 939/1510 [00:13<00:07, 72.12it/s, accuracy=tensor(0.6964), loss=0.903]
Traceback (most recent call last):
  File "/Users/gonterigor/Documents/Imperial/Research/Nornour/0006-LSTM-peptides/scripts/LSTM-peptide-model.py", line 460, in <module>
    avg_epoch_loss, avg_epoch_accuracy = train(train_data, model)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gonterigor/Documents/Imperial/Research/Nornour/0006-LSTM-peptides/scripts/LSTM-peptide-model.py", line 362, in train
    loss.backward()
  File "/opt/anaconda3/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/opt/anaconda3/lib/python3.12/site-packages/torch/autograd/__init__.py", line 340, in backward
    grad_tensors_ = _make_grads(tensors, grad_tensors_, is_grads_batched=False)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/torch/autograd/__init__.py", line 88, in _make_grads
    def _make_grads(

KeyboardInterrupt
